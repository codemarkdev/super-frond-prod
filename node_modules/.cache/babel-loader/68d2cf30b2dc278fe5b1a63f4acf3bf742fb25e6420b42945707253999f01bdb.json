{"ast":null,"code":"export default {\n  props: {\n    showConfirmModal: Boolean,\n    cashInHand: Number,\n    cargando: Boolean,\n    ventasTurno: {\n      type: Number,\n      default: 0\n    },\n    efectivoEsperado: {\n      type: Number,\n      default: 0\n    },\n    actionModal: {\n      type: Function,\n      default: null\n    },\n    // Nuevas props para explicar el efectivo esperado\n    esPrimerCierreDia: {\n      type: Boolean,\n      default: true\n    },\n    hayOtrosCierresHoy: {\n      type: Boolean,\n      default: false\n    },\n    efectivoUltimoCierre: {\n      type: Number,\n      default: 0\n    },\n    efectivoTurnoAnteriorUsuario: {\n      type: Number,\n      default: 0\n    }\n  },\n  data() {\n    return {\n      localShowConfirmModal: this.showConfirmModal,\n      procesando: false\n    };\n  },\n  computed: {\n    discrepancia() {\n      return this.cashInHand - this.efectivoEsperado;\n    }\n  },\n  watch: {\n    showConfirmModal(newVal) {\n      this.localShowConfirmModal = newVal;\n    }\n  },\n  methods: {\n    formatNumber(value) {\n      if (value === null || value === undefined) return '-';\n      return Number(value).toLocaleString('es-MX', {\n        style: 'currency',\n        currency: 'MXN'\n      });\n    },\n    confirmarCierre() {\n      // Evitar múltiples clics\n      if (this.procesando) return;\n      this.procesando = true;\n      this.$emit('confirmar-cierre');\n      this.procesando = false;\n    },\n    handleClose() {\n      this.$emit('update:showConfirmModal', false);\n    }\n  }\n};","map":{"version":3,"names":["props","showConfirmModal","Boolean","cashInHand","Number","cargando","ventasTurno","type","default","efectivoEsperado","actionModal","Function","esPrimerCierreDia","hayOtrosCierresHoy","efectivoUltimoCierre","efectivoTurnoAnteriorUsuario","data","localShowConfirmModal","procesando","computed","discrepancia","watch","newVal","methods","formatNumber","value","undefined","toLocaleString","style","currency","confirmarCierre","$emit","handleClose"],"sources":["src/components/Caja/ConfirModal.vue"],"sourcesContent":["<template>\r\n<b-modal v-model=\"localShowConfirmModal\" has-modal-card trap-focus aria-role=\"dialog\" @close=\"handleClose\">\r\n  <div class=\"modal-card\">\r\n    <header class=\"modal-card-head has-background-primary\">\r\n      <p class=\"modal-card-title has-text-white\">Confirmar Cierre de Caja</p>\r\n    </header>\r\n    <section class=\"modal-card-body\">\r\n      <div class=\"content\">\r\n        <h3>Resumen del Cierre:</h3>\r\n        \r\n        <div class=\"box mb-4\">\r\n          <div class=\"columns is-multiline\">\r\n            <div class=\"column is-6\">\r\n              <p>\r\n                <strong>Ventas del Turno:</strong> \r\n                <span class=\"has-tooltip-multiline\" data-tooltip=\"Total de ventas realizadas durante su turno actual, desde el último cierre de caja.\">\r\n                  {{ formatNumber(ventasTurno) }}\r\n                  <span class=\"icon is-small has-text-info\">\r\n                    <i class=\"mdi mdi-information-outline\"></i>\r\n                  </span>\r\n                </span>\r\n              </p>\r\n            </div>\r\n            <div class=\"column is-6\">\r\n              <p>\r\n                <strong>Efectivo Esperado:</strong> \r\n                <span class=\"has-tooltip-multiline\" data-tooltip=\"Cantidad de efectivo que debería tener en caja según los registros del sistema. Corresponde únicamente a las ventas en efectivo de este turno.\">\r\n                  {{ formatNumber(efectivoEsperado) }}\r\n                  <span class=\"icon is-small has-text-info\">\r\n                    <i class=\"mdi mdi-information-outline\"></i>\r\n                  </span>\r\n                </span>\r\n              </p>\r\n            </div>\r\n            <div class=\"column is-6\">\r\n              <p>\r\n                <strong>Efectivo en Mano:</strong> \r\n                <span class=\"has-tooltip-multiline\" data-tooltip=\"Cantidad de efectivo que usted ha contado físicamente y ha ingresado en el sistema.\">\r\n                  {{ formatNumber(cashInHand) }}\r\n                  <span class=\"icon is-small has-text-info\">\r\n                    <i class=\"mdi mdi-information-outline\"></i>\r\n                  </span>\r\n                </span>\r\n              </p>\r\n            </div>\r\n            <div class=\"column is-6\">\r\n              <p>\r\n                <strong>Discrepancia:</strong> \r\n                <span class=\"has-tooltip-multiline\" :class=\"{'has-text-danger': discrepancia < 0, 'has-text-success': discrepancia > 0, 'has-text-info': discrepancia === 0}\" data-tooltip=\"Diferencia entre el efectivo en mano y el efectivo esperado. Si es positiva, hay más dinero del esperado. Si es negativa, falta dinero.\">\r\n                  {{ formatNumber(discrepancia) }}\r\n                  <span class=\"icon is-small\" :class=\"{'has-text-danger': discrepancia < 0, 'has-text-success': discrepancia > 0, 'has-text-info': discrepancia === 0}\">\r\n                    <i class=\"mdi\" :class=\"{'mdi-alert': discrepancia < 0, 'mdi-check-circle': discrepancia === 0, 'mdi-plus-circle': discrepancia > 0}\"></i>\r\n                  </span>\r\n                </span>\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- Explicación detallada del Efectivo Esperado -->\r\n        <div class=\"notification is-primary is-light mb-4\">\r\n          <p class=\"has-text-centered has-text-weight-bold\">\r\n            <span class=\"icon\">\r\n              <i class=\"mdi mdi-cash-register\"></i>\r\n            </span>\r\n            ¿Cómo se calcula el Efectivo Esperado?\r\n          </p>\r\n          \r\n          <div class=\"content\">\r\n            <p>El <strong>Efectivo Esperado</strong> ({{ formatNumber(efectivoEsperado) }}) corresponde únicamente a las ventas realizadas en su turno:</p>\r\n            \r\n            <div class=\"box has-background-white-ter p-3\">\r\n              <p class=\"mb-2\"><strong>Ventas del Turno:</strong> {{ formatNumber(ventasTurno) }}</p>\r\n              <p class=\"has-text-weight-bold\">Total Efectivo Esperado: {{ formatNumber(efectivoEsperado) }}</p>\r\n            </div>\r\n            \r\n            <p class=\"has-text-centered has-text-weight-bold mt-3\">\r\n              <span class=\"icon\">\r\n                <i class=\"mdi mdi-information\"></i>\r\n              </span>\r\n              Para evitar discrepancias, el Efectivo en Mano debe ser igual al Efectivo Esperado.\r\n            </p>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"notification is-warning is-light\" v-if=\"Math.abs(discrepancia) > 0\">\r\n          <p class=\"has-text-centered\">\r\n            <span class=\"icon\">\r\n              <i class=\"mdi mdi-alert\"></i>\r\n            </span>\r\n            <span v-if=\"discrepancia < 0\">\r\n              <strong>¡Atención!</strong> Hay una discrepancia negativa de {{ formatNumber(Math.abs(discrepancia)) }}. \r\n              Esto significa que hay menos efectivo del esperado. Verifique si hubo algún error en el conteo o si falta dinero.\r\n            </span>\r\n            <span v-else>\r\n              <strong>¡Atención!</strong> Hay una discrepancia positiva de {{ formatNumber(discrepancia) }}. \r\n              Esto significa que hay más efectivo del esperado. Verifique si hubo algún error en el registro de ventas o en el conteo.\r\n            </span>\r\n          </p>\r\n        </div>\r\n        \r\n        <p class=\"has-text-danger has-text-weight-bold\">\r\n          <span class=\"icon\">\r\n            <i class=\"mdi mdi-alert-circle\"></i>\r\n          </span>\r\n          Esta acción no se puede deshacer. Al confirmar, se registrará el cierre con los valores mostrados.\r\n        </p>\r\n      </div>\r\n    </section>\r\n    <footer class=\"modal-card-foot\">\r\n      <button class=\"button is-primary\" :class=\"{ 'is-loading': cargando }\" @click=\"confirmarCierre\" :disabled=\"cargando\">\r\n        <span class=\"icon\">\r\n          <i class=\"mdi mdi-check\"></i>\r\n        </span>\r\n        <span>Confirmar</span>\r\n      </button>\r\n      <button class=\"button\" @click=\"handleClose\" :disabled=\"cargando\">\r\n        <span class=\"icon\">\r\n          <i class=\"mdi mdi-close\"></i>\r\n        </span>\r\n        <span>Cancelar</span>\r\n      </button>\r\n    </footer>\r\n  </div>\r\n</b-modal>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\nprops: {\r\n  showConfirmModal: Boolean,\r\n  cashInHand: Number,\r\n  cargando: Boolean,\r\n  ventasTurno: {\r\n    type: Number,\r\n    default: 0\r\n  },\r\n  efectivoEsperado: {\r\n    type: Number,\r\n    default: 0\r\n  },\r\n  actionModal: {\r\n    type: Function,\r\n    default: null\r\n  },\r\n  // Nuevas props para explicar el efectivo esperado\r\n  esPrimerCierreDia: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  hayOtrosCierresHoy: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  efectivoUltimoCierre: {\r\n    type: Number,\r\n    default: 0\r\n  },\r\n  efectivoTurnoAnteriorUsuario: {\r\n    type: Number,\r\n    default: 0\r\n  }\r\n},\r\ndata() {\r\n  return {\r\n    localShowConfirmModal: this.showConfirmModal,\r\n    procesando: false\r\n  };\r\n},\r\ncomputed: {\r\n  discrepancia() {\r\n    return this.cashInHand - this.efectivoEsperado;\r\n  }\r\n},\r\nwatch: {\r\n  showConfirmModal(newVal) {\r\n    this.localShowConfirmModal = newVal;\r\n  }\r\n},\r\nmethods: {\r\n  formatNumber(value) {\r\n    if (value === null || value === undefined) return '-';\r\n    return Number(value).toLocaleString('es-MX', { style: 'currency', currency: 'MXN' });\r\n  },\r\n  confirmarCierre() {\r\n    // Evitar múltiples clics\r\n    if (this.procesando) return;\r\n    \r\n    this.procesando = true;\r\n    this.$emit('confirmar-cierre');\r\n    this.procesando = false;\r\n  },\r\n  handleClose() {\r\n    this.$emit('update:showConfirmModal', false);\r\n  }\r\n}\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.mb-2 {\r\nmargin-bottom: 0.5rem;\r\n}\r\n\r\n.mb-4 {\r\nmargin-bottom: 1rem;\r\n}\r\n\r\n.mt-3 {\r\nmargin-top: 0.75rem;\r\n}\r\n\r\n.p-3 {\r\npadding: 0.75rem;\r\n}\r\n\r\n.has-tooltip-multiline {\r\nposition: relative;\r\ncursor: help;\r\n}\r\n\r\n.modal-card {\r\nmax-width: 600px;\r\nwidth: 100%;\r\n}\r\n\r\n.notification ul {\r\nmargin-left: 1.5rem;\r\nmargin-top: 0.5rem;\r\n}\r\n\r\n.notification ul li {\r\nmargin-bottom: 0.25rem;\r\n}\r\n\r\n.icon {\r\nmargin-right: 0.25rem;\r\nvertical-align: middle;\r\n}\r\n\r\n.is-divider {\r\nheight: 1px;\r\nbackground-color: #dbdbdb;\r\nmargin: 1rem 0;\r\n}\r\n</style>\r\n\r\n"],"mappings":"AAgIA;EACAA,KAAA;IACAC,gBAAA,EAAAC,OAAA;IACAC,UAAA,EAAAC,MAAA;IACAC,QAAA,EAAAH,OAAA;IACAI,WAAA;MACAC,IAAA,EAAAH,MAAA;MACAI,OAAA;IACA;IACAC,gBAAA;MACAF,IAAA,EAAAH,MAAA;MACAI,OAAA;IACA;IACAE,WAAA;MACAH,IAAA,EAAAI,QAAA;MACAH,OAAA;IACA;IACA;IACAI,iBAAA;MACAL,IAAA,EAAAL,OAAA;MACAM,OAAA;IACA;IACAK,kBAAA;MACAN,IAAA,EAAAL,OAAA;MACAM,OAAA;IACA;IACAM,oBAAA;MACAP,IAAA,EAAAH,MAAA;MACAI,OAAA;IACA;IACAO,4BAAA;MACAR,IAAA,EAAAH,MAAA;MACAI,OAAA;IACA;EACA;EACAQ,KAAA;IACA;MACAC,qBAAA,OAAAhB,gBAAA;MACAiB,UAAA;IACA;EACA;EACAC,QAAA;IACAC,aAAA;MACA,YAAAjB,UAAA,QAAAM,gBAAA;IACA;EACA;EACAY,KAAA;IACApB,iBAAAqB,MAAA;MACA,KAAAL,qBAAA,GAAAK,MAAA;IACA;EACA;EACAC,OAAA;IACAC,aAAAC,KAAA;MACA,IAAAA,KAAA,aAAAA,KAAA,KAAAC,SAAA;MACA,OAAAtB,MAAA,CAAAqB,KAAA,EAAAE,cAAA;QAAAC,KAAA;QAAAC,QAAA;MAAA;IACA;IACAC,gBAAA;MACA;MACA,SAAAZ,UAAA;MAEA,KAAAA,UAAA;MACA,KAAAa,KAAA;MACA,KAAAb,UAAA;IACA;IACAc,YAAA;MACA,KAAAD,KAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}